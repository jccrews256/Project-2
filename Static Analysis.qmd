---
title: "Initial Analysis of NFL Play-by-Play Data"
author: "Cass Crews"
format: html
editor: visual
---

# Loading Packages

```{r}
library(tidyverse)
library(lubridate)
```


# Reading in Data

We need to read in the data and do some initial filtering; we will focus our analysis on only run and pass plays in the 2018-2019 season. 

```{r}
#Reading in data and filtering to passes and runs in the 2018-2019 season
play_data<-read_csv("NFL Play by Play 2009-2018 (v5).csv") |>
  filter(play_type %in% c("pass","run"),game_date >= ymd("2018-06-01"))
```
# Categorical Variable NUmeric Summaries

For this analysis, we will focus on 

As an initial step, let's explore the distribution between passes and runs.

```{r}
#Generating pass-run breakdown
play_data |>
  group_by(play_type) |>
  summarize(count=n()) |>
  ungroup() |>
  mutate(tot_plays=sum(count),proportion=count/tot_plays) |>
  select(!tot_plays)
```

Thus, 59.4% of plays in the 2018-2019 season were pass plays. 

Let's find out the breakdown between pass plays that resulted in a sack and pass plays that did not. 

```{r}
#Generating sack-not breakdown
play_data |>
  filter(play_type=="pass") |>
  group_by(sack) |>
  summarize(count=n()) |>
  mutate(tot_plays=sum(count),proportion=count/tot_plays) |>
  select(!tot_plays)
```

The data indicate 93% of pass plays resulted in a sack. 

Which type of play was more likely to result in a turnover? 

```{r}
#Generating turnover rates by play type
play_data |>
  #Identifying turnovers as lost fumbles and interceptions
  mutate(turnover=if_else(fumble_lost==1 | interception==1,"yes","no")) |>
  group_by(play_type,turnover) |>
  summarize(count=n()) |>
  ungroup() |>
  group_by(play_type) |>
  mutate(tot_plays=sum(count),proportion=count/tot_plays) |>
  select(!tot_plays)
```

It seems pass plays are much more likely to result in turnovers. 

How does the pass-run breakdown differ when a team is winning (or tied) and when it is losing? 

```{r}
#Generating pass-run breakdown for winning (or tied) and losing
play_data |>
  mutate(winning=if_else(score_differential>=0,"winning or tied","losing")) |>
  group_by(winning,play_type) |>
  summarize(count=n()) |>
  ungroup() |>
  group_by(winning) |>
  mutate(tot_plays=sum(count),proportion=count/tot_plays) |>
  select(!tot_plays)
```


Not surprisingly, teams are more likely to pass when they are losing than when they are winning. 


How does the run-pass breakdown vary across quarters? Note that the fifth quarter indicates overtime. 

```{r}
#Generating pass-run breakdown by quarter
play_data |>
  group_by(qtr,play_type) |>
  summarize(count=n()) |>
  ungroup() |>
  group_by(qtr) |>
  mutate(tot_plays=sum(count),proportion=count/tot_plays) |>
  select(!tot_plays)
```

Notably, passing plays are more common in quarters that end either the half or the game. This may indicate that coaches feel a greater sense of urgency near the end of the half/game. 


# Numeric Variable Numeric Summaries


